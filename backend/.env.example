# SSA Intelligence Backend - Environment Variables
# Copy this file to .env and fill in your values

# ============================================================================
# DATABASE (REQUIRED)
# ============================================================================

# PostgreSQL Connection String
# For Render: Use the Internal Database URL from your Render PostgreSQL service
DATABASE_URL="postgresql://user:password@localhost:5432/ssa_intelligence"

# ============================================================================
# ANTHROPIC API (REQUIRED)
# ============================================================================

# Anthropic API Key - get from https://console.anthropic.com/
ANTHROPIC_API_KEY="sk-ant-api03-..."

# Claude Model to use (optional - defaults to claude-sonnet-4-5)
CLAUDE_MODEL="claude-sonnet-4-5"

# Max tokens per API call (optional)
MAX_TOKENS=16000

# ============================================================================
# SERVER CONFIGURATION
# ============================================================================

# Node Environment: development | production
NODE_ENV="development"

# Server Port (Render sets this automatically)
PORT="3000"

# CORS Origin - Frontend URL
# For development: http://localhost:5174
# For Render: https://your-app-name.onrender.com
CORS_ORIGIN="http://localhost:5174"

# ============================================================================
# SECURITY
# ============================================================================

# JWT Secret for API authentication
# Generate with: openssl rand -base64 32
# For Render: Use generateValue: true in render.yaml
JWT_SECRET="your-secret-key-here"

# ============================================================================
# API RATE LIMITING (Production only)
# ============================================================================

# High-frequency GET polling endpoints
RATE_LIMIT_GET_WINDOW_MS="300000"      # 5 minutes
RATE_LIMIT_GET_MAX="2000"

# Job generation (heavy)
RATE_LIMIT_GENERATE_WINDOW_MS="900000" # 15 minutes
RATE_LIMIT_GENERATE_MAX="10"

# PDF export (heavy)
RATE_LIMIT_EXPORT_WINDOW_MS="3600000"  # 60 minutes
RATE_LIMIT_EXPORT_MAX="20"

# Writes (cancel/delete/feedback)
RATE_LIMIT_WRITE_WINDOW_MS="900000"    # 15 minutes
RATE_LIMIT_WRITE_MAX="60"

# ============================================================================
# OPTIONAL FEATURES
# ============================================================================

# Public logo.dev token served via /api/config
LOGO_DEV_TOKEN=""

# Maximum concurrent research jobs
MAX_CONCURRENT_JOBS="3"

# Job retry configuration
MAX_SECTION_RETRIES="3"
RETRY_DELAY_MS="5000"

# ============================================================================
# LOGGING
# ============================================================================

# Log Level: error | warn | info | debug
LOG_LEVEL="info"

# Enable detailed logging
DEBUG="false"

# Enable Claude API response caching (development only)
CLAUDE_CACHE_ENABLED="false"

# ============================================================================
# THUMBNAIL STORAGE (Optional - S3 compatible)
# ============================================================================

# THUMBNAIL_S3_BUCKET=""
# THUMBNAIL_S3_REGION=""
# THUMBNAIL_S3_ENDPOINT=""      # Optional for S3-compatible providers
# THUMBNAIL_S3_KEY=""
# THUMBNAIL_S3_SECRET=""
# THUMBNAIL_S3_PUBLIC_BASE=""   # Optional public base URL override

# ============================================================================
# PRODUCTION QUICK REFERENCE
# ============================================================================
# For Render deployment, set these environment variables:
#
# Required:
#   DATABASE_URL        - From Render PostgreSQL service
#   ANTHROPIC_API_KEY   - Your Anthropic API key
#   CORS_ORIGIN         - Your Render app URL (https://your-app.onrender.com)
#   JWT_SECRET          - Auto-generated by render.yaml
#   NODE_ENV            - production
#
# Optional but recommended:
#   LOG_LEVEL           - warn (for production)
#   DEBUG               - false
